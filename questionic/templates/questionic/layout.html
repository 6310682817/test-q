{% load static %}
{% load humanize %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Questionic</title>
        <meta charset="utf-8">
        <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/1763/1763016.png">
        <link rel="stylesheet" href="{% static 'css/notification.css' %}">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
    
        <!-- Font Awesome -->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"/>
        <!-- Google Fonts -->
        <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet"/>
        <!-- MDB -->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.0.0/mdb.min.css" rel="stylesheet"/>
        <!-- MDB -->
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.0.0/mdb.min.js"></script>
        <style>
          .logo{
              color: #000;
              font-size: 25px;
              font-weight: 700;
          }
        </style>
        <script src="https://cdn.tiny.cloud/1/ivgfsy3op8dcdo67r7m4kalo70imr8acsz9frooi6aaqx59d/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
        <script>
          tinymce.init({
            selector: 'textarea#editor',
            skin: 'bootstrap',
            plugins: 'anchor autolink charmap codesample emoticons image link lists media searchreplace table visualblocks wordcount checklist mediaembed casechange export formatpainter pageembed linkchecker a11ychecker tinymcespellchecker permanentpen powerpaste advtable advcode editimage tinycomments tableofcontents footnotes mergetags autocorrect codesample',
            toolbar: 'undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table mergetags | addcomment showcomments | spellcheckdialog a11ycheck | align lineheight | checklist numlist bullist indent outdent | emoticons charmap | removeformat | codesample',
            menubar: false,
            statusbar: false,
            });
        </script>
    
    </head>
    <body>
        {% block nav %}
          <!-- Navbar-->
          <nav class="navbar navbar-expand-lg navbar-light bg-light" style="padding-left:30px;">
              <div class="container-fluid justify-content-between">
                <!-- Left elements -->
                <div class="d-flex">
                  <!-- Brand -->
                  <a class="navbar-brand me-2 mb-1 d-flex align-items-center" href="{% url 'questionic:index' %}">
                      <div class="logo">Questionic</div>
                  </a>
            
                  <!-- Search form -->
                  <form action="{% url 'questionic:search' %}" method="get" class="input-group w-auto my-auto d-none d-sm-flex">
                    <input autocomplete="off" type="search" name="search_keyword" class="form-control rounded" placeholder="Search" style="min-width: 125px; margin-left:30px;"/>
                    <span class="input-group-text border-0 d-none d-lg-flex"><i class="fas fa-search"></i></span>
                  </form>
                </div>
                <!-- Left elements -->
          
                <!-- Right elements -->
                {% if user.is_authenticated %}
                <ul class="navbar-nav flex-row">
                  <li class="nav-item me-3 me-lg-1">
                    <a class="nav-link d-sm-flex align-items-sm-center" href="{% url 'users:index' %}">
                      
                      <img src="{{account.image_profile.url}}" class="rounded-circle" height="22" alt="Black and White Portrait of a Man" loading="lazy"/>
                      <strong class="d-none d-sm-block ms-1">{{account.user}}</strong>
                    </a>
                  </li>
                  <li class="nav-item me-3 me-lg-1">
                    <a class="nav-link" href="{% url 'questionic:post_question' %}">
                      <span><i class="fas fa-plus-circle fa-lg"></i></span>
                    </a>
                  </li>
                  <li class="nav-item me-3 me-lg-1">
                    <a class="nav-link" href="{% url 'questionic:notification' %}">
                      <i class="fas fa-bell fa-lg"></i>
                      <span id="badge_alert" class="badge rounded-pill badge-notification bg-danger">{{notification_alert}}</span>

                    </a>
                  </li>
                  
                  <li class="nav-item dropdown me-3 me-lg-1">
                    <a class="nav-link dropdown-toggle hidden-arrow" href="{% url 'questionic:notification' %}" id="navbarDropdownMenuLink" role="button" data-mdb-toggle="dropdown" aria-expanded="false">
                      <i class="fas fa-chevron-circle-down fa-lg"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdownMenuLink">
                      <li>
                        <a class="dropdown-item" href="{% url 'questionic:about' %}">About</a>
                      </li>
                      <li>
                        <a class="dropdown-item" href="{% url 'users:logout' %}"><i class="fas fa-sign-out-alt"></i> Log out</a>
                      </li>
                    </ul>
                  </li>
                  
                </ul>
                
              </div>
                {% else %}
                <div class="d-flex align-items-center">
                  <a href="{% url 'users:login'%}">
                  <button type="button" class="btn btn-link px-3 me-2">
                    Login
                  </button>
                </a>
                <a href="{% url 'users:signup'%}">
                  <button type="button" class="btn btn-primary me-3">
                    Sign up
                  </button>
                </a>
                </div>
                {% endif %}
                <!-- Right elements -->
              </div>
            </nav>
            <!-- Navbar -->
        
        {% endblock%}
        {% block body %}
        {% endblock %}
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.min.js" integrity="sha384-7VPbUDkoPSGFnVtYi0QogXtr74QeVeeIs99Qfg5YCF+TidwNdjvaKZX19NZ/e6oz" crossorigin="anonymous"></script>
    </body>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        function loadDoc() {
            const xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (xhttp.readyState === XMLHttpRequest.DONE) {
                    const status = xhttp.status;
                    if (status === 0 || (status >= 200 && status < 400)) {
                        data = JSON.parse(this.responseText)
                        document.getElementById("badge_alert").innerHTML = data.notification_alert;
                    }
                }
            }
            xhttp.open("GET", "{% url 'questionic:notification_alert'%}");
            xhttp.send(); 
        }
          
        setInterval(function() {
            loadDoc();
        },5000);
    </script>
</html>